# PixelOE.js - 像素艺术生成器

基于对比度感知轮廓扩展的细节导向像素化算法的 JavaScript/TypeScript 实现。

## ✨ 特性

- 🎨 **高质量像素化**: 基于原创算法，保持图像细节
- 🚀 **纯浏览器运行**: 无需服务器，完全在客户端处理
- ⚡ **性能优化**: 针对大图像进行了栈溢出和内存优化
- 🎯 **多种模式**: 支持对比度感知、中心像素、双线性等下采样模式
- 🔧 **参数可调**: 像素大小、轮廓厚度、色彩调整等
- 📱 **响应式界面**: 现代化 Vue 3 界面，支持移动端

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

然后打开 `http://localhost:5174/` 查看应用。

### 构建生产版本

```bash
npm run build
```

## 🎯 使用方法

1. **选择图像**: 点击"选择图像文件"按钮上传图片
2. **调整参数**: 使用控制面板调整处理参数
3. **开始处理**: 点击"开始处理"按钮
4. **下载结果**: 处理完成后下载 PNG 格式结果

### 参数说明

- **像素大小 (2-16)**: 控制最终像素的大小，值越大像素越明显
- **轮廓厚度 (0-5)**: 控制轮廓扩展的强度，有助于保持细节
- **下采样模式**:
  - `对比度感知`: 智能选择最具代表性的像素（推荐）
  - `中心像素`: 选择每个区块的中心像素
  - `双线性`: 使用双线性插值
  - `最近邻`: 使用最近邻插值
- **对比度/饱和度**: 调整最终图像的色彩效果
- **颜色匹配**: 保持与原图相似的色彩风格

## 🔧 性能优化

该实现包含多项性能优化，专门针对大图像处理：

### 大图像处理

- **自动缩放**: 超过 2MP 的图像会自动缩放以避免内存问题
- **栈溢出防护**: 优化了数组操作，避免在大数据集上出现栈溢出
- **自适应参数**: 大图像会自动调整处理参数以提高速度

### 内存管理

- **Float32Array**: 使用类型化数组提高内存效率
- **分块处理**: 大数组操作使用循环而非展开操作符
- **采样优化**: 对大数组使用采样计算中位数等统计值

## 📁 项目结构

```
src/
├── core/                   # 核心算法
│   ├── imageData.ts        # 图像数据处理
│   ├── colorSpace.ts       # 颜色空间转换
│   ├── morphology.ts       # 形态学操作
│   ├── outline.ts          # 轮廓扩展算法
│   ├── downscale.ts        # 下采样算法
│   └── color.ts            # 颜色处理
├── utils/                  # 工具函数
│   └── math.ts             # 数学工具函数
├── components/             # Vue 组件
│   └── PixelOEDemo.vue     # 主演示组件
├── pixeloe.ts              # PixelOE 主类
├── index.ts                # 导出模块
└── App.vue                 # 应用入口
```

## 🔍 算法原理

### 1. 对比度感知轮廓扩展

- 计算局部对比度统计信息
- 生成权重图识别重要特征
- 应用选择性形态学操作

### 2. 智能下采样

- 转换到 LAB 色彩空间
- 基于局部统计选择代表性像素
- 分离处理亮度和色彩通道

### 3. 色彩处理

- 颜色匹配保持原始风格
- 小波样式的色彩修正
- HSV 色彩调整

## ⚠️ 已知限制

1. **处理时间**: 大图像处理可能需要几秒到几十秒
2. **内存使用**: 超大图像会被自动缩放
3. **浏览器兼容**: 需要支持 Canvas API 和现代 JavaScript

## 🛠️ 技术栈

- **Vue 3** - 响应式用户界面
- **TypeScript** - 类型安全
- **Vite** - 构建工具
- **Canvas API** - 图像处理
- **Float32Array** - 高效数值计算

## 📝 更新日志

### v0.1.0 (当前版本)

- ✅ 完整的 PixelOE 算法实现
- ✅ 现代化 Vue 3 用户界面
- ✅ 大图像优化和错误处理
- ✅ 多种下采样模式
- ✅ 参数实时调整
- ✅ 结果下载功能

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

本项目基于原始 Python 版本的许可证。

## 🙏 致谢

感谢原始 PixelOE Python 实现的作者，本项目是其 JavaScript 移植版本。
